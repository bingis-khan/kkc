#!./zig-out/bin/kkc
use Alloc
use List
use Slice

al = Alloc.get-c-allocator()
s = 1 to (10)
	to-list(al)
	List.to-slice()

inst ListLike Slice
	deconstruct (self, lp, lc, spread, rp, rc)
		if lc > 0
			if lc > self.count
				return False

			lp <&= self.ptr

		if rc > 0
			if rc + lc > self.count
				return False

			cut = self
				subslice(self.count - rc, self.count)

			rp <&= cut.ptr

		case spread
			NoSpread
				return lc + rc == self.count

			UnassignedSpread
				return True

			AssignedSpread(xptr)
				xptr <&= self
					subslice(lc, self.count - rc)
				return True

				
# case s
# 	[x, ...xs]
# 		println(x)
# 		println(xs)

# 	xs
# 		println('not matched: \(xs)')

case 5 to (10)
	[x, y, ..., z]
		println(x)
		println(y)
		println(z)
	xs
		xs for-each(println)
		# println('not matched: \(xs)')
1 to (10) to-list(al) println()
s println()

al Alloc.free(s)
